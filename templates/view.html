{{ define "content" }}
<div class="note-view-container">
    <div class="note-view-actions">
        <a href="/dashboard" class="back-button">‚Üê Back to Dashboard</a>
        <div class="action-buttons">
            <a href="/notes/edit/{{ .Note.ID }}" class="action-button edit-button">
                <i class="fas fa-edit"></i> Edit
            </a>
            <form method="POST" action="/notes/delete/{{ .Note.ID }}" onsubmit="return confirm('Are you sure you want to delete this note?');">
                <button type="submit" class="action-button delete-button">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </form>
        </div>
    </div>

    <div class="note-view-header">
        <h1>{{ .Note.Title }}</h1>
        <div class="note-meta">
            <span class="note-flags">
                {{ if .Note.IsPinned }}<span class="pinned-flag">üìå Pinned</span>{{ end }}
                {{ if .Note.IsStarred }}<span class="starred-flag">‚≠ê Starred</span>{{ end }}
            </span>
            <span class="note-date">Created: {{ .Note.CreatedAt.Format "Jan 2, 2006 at 3:04 PM" }}</span>
        </div>
    </div>

    {{ if .Note.Tags }}
    <div class="note-tags">
        {{ range split .Note.Tags "," }}
        <span class="note-tag" data-tag="{{ . }}">{{ . }}</span>
        {{ end }}
    </div>
    {{ end }}

    <div class="note-content">
        {{- .Note.Content | safeHTML }}
    </div>
</div>

<style>
    .note-view-container {
        max-width: 1200px;
    }

    .note-view-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .back-button {
        color: #4f46e5;
        text-decoration: none;
        font-weight: 500;
        font-size: 1rem;
        transition: all 0.2s ease;
    }

    .back-button:hover {
        text-decoration: underline;
        color: #3730a3;
    }

    .action-buttons {
        display: flex;
        gap: 0.75rem;
    }

    .action-button {
        padding: 0.5rem 1.25rem;
        border-radius: 6px;
        font-weight: 500;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.2s ease;
        box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }

    .edit-button {
        background-color: #4f46e5;
        color: white;
        border: none;
    }

    .edit-button:hover {
        background-color: #4338ca;
        transform: translateY(-1px);
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    .delete-button {
        background-color: #f3f4f6;
        color: #dc2626;
        border: none;
    }

    .delete-button:hover {
        background-color: #fee2e2;
        transform: translateY(-1px);
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    .note-view-header {
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid #e5e7eb;
    }

    .note-view-header h1 {
        font-size: 2.25rem;
        color: #111827;
        font-weight: 700;
        line-height: 1.2;
    }

    .note-meta {
        display: flex;
        justify-content: space-between;
        color: #6b7280;
        font-size: 0.9rem;
    }

    .note-flags {
        display: flex;
        gap: 1rem;
    }

    .pinned-flag, .starred-flag {
        display: flex;
        align-items: center;
        gap: 0.25rem;
        background-color: #f3f4f6;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.8rem;
    }

    .note-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 1.5rem;
    }

    .note-tag {
        padding: 0.375rem 0.875rem;
        border-radius: 9999px;
        font-size: 0.85rem;
        font-weight: 500;
        color: white;
        transition: all 0.2s ease;
        box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    .note-tag:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        filter: brightness(110%);
    }

    .note-content {
        white-space: pre-wrap; /* preserves line breaks but allows lists to render */
        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,
        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        overflow: auto;
        background: #f8f8f8;
        padding: 1rem 1.25rem;
        border-radius: 4px;
        border: 1px solid #e5e7eb;
        font-size: 1rem;
        color: #111827;
        line-height: 1.5;
    }

    /* Style bullet and numbered lists inside note content */
    .note-content ul,
    .note-content ol {
        padding-left: 1.5rem;
        margin: 0.5rem 0 1rem 0;
    }

    .note-content ul {
        list-style-type: disc;
    }

    .note-content ol {
        list-style-type: decimal;
    }

    /* Optional: list item spacing */
    .note-content li {
        margin-bottom: 0.3rem;
    }

</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Beautiful color palette with good contrast
        const colorPalette = [
            '#3B82F6', // blue-500
            '#EF4444', // red-500
            '#10B981', // green-500
            '#F59E0B', // yellow-500
            '#8B5CF6', // purple-500
            '#EC4899', // pink-500
            '#14B8A6', // teal-500
            '#F97316', // orange-500
            '#64748B', // slate-500
            '#84CC16', // lime-500
            '#06B6D4', // cyan-500
            '#A855F7'  // violet-500
        ];

        // Assign consistent colors based on tag text
        document.querySelectorAll('.note-tag').forEach(tag => {
            const tagText = tag.getAttribute('data-tag').toLowerCase();

            // Simple hash function to get consistent index
            let hash = 0;
            for (let i = 0; i < tagText.length; i++) {
                hash = tagText.charCodeAt(i) + ((hash << 5) - hash);
            }

            // Get color index from hash
            const colorIndex = Math.abs(hash) % colorPalette.length;
            const color = colorPalette[colorIndex];

            // Apply color with hover effect
            tag.style.backgroundColor = color;
            tag.style.setProperty('--tag-color', color);

            // Add slight darkening on hover
            tag.addEventListener('mouseenter', () => {
                tag.style.filter = 'brightness(1.1)';
            });
            tag.addEventListener('mouseleave', () => {
                tag.style.filter = 'brightness(1)';
            });
        });
    });
</script>
{{ end }}